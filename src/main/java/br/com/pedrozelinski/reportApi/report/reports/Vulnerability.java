package br.com.pedrozelinski.reportApi.report.reports;

import java.util.HashMap;
import java.util.List;
import java.util.Map;

import com.fasterxml.jackson.annotation.JsonAnyGetter;
import com.fasterxml.jackson.annotation.JsonAnySetter;
import com.fasterxml.jackson.annotation.JsonFormat;
import com.fasterxml.jackson.annotation.JsonIgnore;
import com.fasterxml.jackson.annotation.JsonProperty;

import br.com.pedrozelinski.reportApi.report.fields.CurrentSituation;
import br.com.pedrozelinski.reportApi.report.fields.Evidency;
import br.com.pedrozelinski.reportApi.report.fields.Metric;
import br.com.pedrozelinski.reportApi.report.fields.Reference;
import br.com.pedrozelinski.reportApi.report.fields.State;
import net.sf.jasperreports.engine.JasperReport;

public class Vulnerability implements IReport{
	
	@JsonProperty("metricas")
	@JsonFormat(with = JsonFormat.Feature.ACCEPT_SINGLE_VALUE_AS_ARRAY)
	private List<Metric> metricas = null;
	
	@JsonProperty("estado")
	@JsonFormat(with = JsonFormat.Feature.ACCEPT_SINGLE_VALUE_AS_ARRAY)
	private List<State> estado = null;

	@JsonProperty("referencias")
	@JsonFormat(with = JsonFormat.Feature.ACCEPT_SINGLE_VALUE_AS_ARRAY)
	private List<Reference> referencias = null;
	
	@JsonProperty("situacao_encontrada")
	@JsonFormat(with = JsonFormat.Feature.ACCEPT_SINGLE_VALUE_AS_ARRAY)
	private List<CurrentSituation> situacaoEncontrada = null;
	@JsonProperty("id_ponto")
	private Integer idPonto;
	@JsonProperty("ativado")
	private Boolean ativado;
	@JsonProperty("uso")
	private String uso;
	@JsonProperty("_id")
	private String id;
	@JsonProperty("id_projeto")
	private String idProjeto;
	@JsonProperty("vulnerabilidade")
	private String vulnerabilidade;
	@JsonProperty("tipo")
	private String tipo;
	@JsonProperty("owasp")
	private String owasp;
	@JsonProperty("otg")
	private String otg;
	@JsonProperty("sistemas_afetados")
	private String sistemasAfetados;
	@JsonProperty("melhores_praticas")
	private String melhoresPraticas;
	@JsonProperty("modelagens")
	private String modelagens;
	@JsonProperty("classificador")
	private String classificador;
	@JsonProperty("id_archer")
	private String idArcher;
	@JsonProperty("rfc")
	private String rfc;
	@JsonProperty("tipificacao")
	private String tipificacao;
	@JsonProperty("risco_de_negocio")
	private String riscoDeNegocio;
	@JsonProperty("logo")
	private String logo;
	@JsonProperty("cliente")
	private String cliente;
	@JsonProperty("projeto")
	private String projeto;
	@JsonProperty("evidencias")
	@JsonFormat(with = JsonFormat.Feature.ACCEPT_SINGLE_VALUE_AS_ARRAY)
	private List<Evidency> evidencias = null;
	@JsonProperty("reteste")
	@JsonFormat(with = JsonFormat.Feature.ACCEPT_SINGLE_VALUE_AS_ARRAY)
	private List<Retest> reteste = null;
	@JsonProperty("apontamentos")
	@JsonFormat(with = JsonFormat.Feature.ACCEPT_SINGLE_VALUE_AS_ARRAY)
	private List<Vulnerability> apontamentos = null;	
	@JsonIgnore
	private Map<String, Object> additionalProperties = new HashMap<String, Object>();
	

	@JsonProperty("subretestes")
	@JsonFormat(with = JsonFormat.Feature.ACCEPT_SINGLE_VALUE_AS_ARRAY)
	private List<Retest> subretestes = null;
	@JsonProperty("subretestereport")
	private JasperReport subretestereport = null;	
	
	public Map<String, Object> reportMapper (Map<String, Object> fields){
		fields.put("id_projeto", this.getIdProjeto());
		fields.put("id_ponto", this.getIdPonto());
		fields.put("ativado", this.getAtivado());
		fields.put("vulnerabilidade", this.getVulnerabilidade());
		fields.put("uso", this.getUso());
		fields.put("tipo", this.getTipo());
		fields.put("metricas", this.getMetricas());
		fields.put("owasp", this.getOwasp());
		fields.put("otg", this.getOtg());
		fields.put("estado", this.getEstado());
		fields.put("referencias", this.getReferencias());
		fields.put("sistemas_afetados", this.getSistemasAfetados());
		fields.put("situacao_encontrada", this.getSituacaoEncontrada());
		fields.put("melhores_praticas", this.getMelhoresPraticas());
		fields.put("modelagens", this.getModelagens());
		fields.put("classificador", this.getClassificador());
		fields.put("rfc", this.getRfc());
		fields.put("id_archer", this.getIdArcher());
		fields.put("tipificacao", this.getTipificacao());
		fields.put("risco_de_negocio", this.getRiscoDeNegocio());
		fields.put("evidencias", this.getEvidencia());	
		if(this.getRetestes() != null)
			for (Retest retest : this.getRetestes())
				retest.setLogo(this.getLogo());
		fields.put("retestes", this.getRetestes());
		fields.put("logo", this.getLogo());
		if(this.getApontamentos() != null)
			for (Vulnerability apontamento : this.getApontamentos()) {
				apontamento.setLogo(this.getLogo());
				if(apontamento.getRetestes() != null)
					for (Retest retest : apontamento.getRetestes())
						retest.setLogo(this.getLogo());
			}
		fields.put("apontamentos", this.getApontamentos());
		return fields;
	}


	@JsonProperty("metricas")
	public List<Metric> getMetricas() {
	return metricas;
	}

	@JsonProperty("metricas")
	public void setMetricas(List<Metric> metricas) {
	this.metricas = metricas;
	}

	public Vulnerability withMetrics(List<Metric> metricas) {
	this.metricas = metricas;
	return this;
	}

	@JsonProperty("estado")
	public List<State> getEstado() {
	return estado;
	}

	@JsonProperty("estado")
	public void setEstado(List<State> estado) {
	this.estado = estado;
	}

	public Vulnerability withState(List<State> estado) {
	this.estado = estado;
	return this;
	}

	@JsonProperty("referencias")
	public List<Reference> getReferencias() {
	return referencias;
	}
	
	@JsonProperty("referencias")
	public void setReferencias(List<Reference> references) {
	this.referencias = references;
	}
	
	public Vulnerability withReferencias(List<Reference> references) {
	this.referencias = references;
	return this;
	}

	@JsonProperty("situacao_encontrada")
	public List<CurrentSituation> getSituacaoEncontrada() {
	return situacaoEncontrada;
	}

	@JsonProperty("situacaoencontradaformatado")
	public List<CurrentSituation> getSituacaoencontradaformatado() {
	return situacaoEncontrada;
	}

	@JsonProperty("situacao_encontrada")
	public void setSituacaoEncontrada(List<CurrentSituation> situacaoEncontrada) {
	this.situacaoEncontrada = situacaoEncontrada;
	}

	public Vulnerability withCurrentSituation(List<CurrentSituation> situacaoEncontrada) {
	this.situacaoEncontrada = situacaoEncontrada;
	return this;
	}

	@JsonProperty("id_ponto")
	public Integer getIdPonto() {
	return idPonto;
	}
	
	@JsonProperty("idpontoformatado")
	public Integer getIdpontoformatado() {
	return idPonto;
	}

	@JsonProperty("id_ponto")
	public void setIdPonto(Integer idPonto) {
	this.idPonto = idPonto;
	}

	public Vulnerability withIdPonto(Integer idPonto) {
	this.idPonto = idPonto;
	return this;
	}

	@JsonProperty("ativado")
	public Boolean getAtivado() {
	return ativado;
	}

	@JsonProperty("ativado")
	public void setAtivado(Boolean ativado) {
	this.ativado = ativado;
	}

	public Vulnerability withAtivado(Boolean ativado) {
	this.ativado = ativado;
	return this;
	}

	@JsonProperty("uso")
	public String getUso() {
	return uso;
	}

	@JsonProperty("uso")
	public void setUso(String uso) {
	this.uso = uso;
	}

	public Vulnerability withUso(String uso) {
	this.uso = uso;
	return this;
	}

	@JsonProperty("_id")
	public String getId() {
	return id;
	}

	@JsonProperty("_id")
	public void setId(String id) {
	this.id = id;
	}

	public Vulnerability withId(String id) {
	this.id = id;
	return this;
	}

	@JsonProperty("id_projeto")
	public String getIdProjeto() {
	return idProjeto;
	}

	@JsonProperty("idprojetoformatado")
	public String getIdprojetoformatado() {
	return idProjeto;
	}

	@JsonProperty("id_projeto")
	public void setIdProjeto(String idProjeto) {
	this.idProjeto = idProjeto;
	}

	public Vulnerability withIdProjeto(String idProjeto) {
	this.idProjeto = idProjeto;
	return this;
	}

	@JsonProperty("vulnerabilidade")
	public String getVulnerabilidade() {
	return vulnerabilidade;
	}

	@JsonProperty("vulnerabilidade")
	public void setVulnerabilidade(String vulnerabilidade) {
	this.vulnerabilidade = vulnerabilidade;
	}

	public Vulnerability withVulnerabilidade(String vulnerabilidade) {
	this.vulnerabilidade = vulnerabilidade;
	return this;
	}

	@JsonProperty("tipo")
	public String getTipo() {
	return tipo;
	}

	@JsonProperty("tipo")
	public void setTipo(String tipo) {
	this.tipo = tipo;
	}

	public Vulnerability withTipo(String tipo) {
	this.tipo = tipo;
	return this;
	}

	@JsonProperty("owasp")
	public String getOwasp() {
	return owasp;
	}

	@JsonProperty("owasp")
	public void setOwasp(String owasp) {
	this.owasp = owasp;
	}

	public Vulnerability withOwasp(String owasp) {
	this.owasp = owasp;
	return this;
	}

	@JsonProperty("otg")
	public String getOtg() {
	return otg;
	}

	@JsonProperty("otg")
	public void setOtg(String otg) {
	this.otg = otg;
	}

	public Vulnerability withOtg(String otg) {
	this.otg = otg;
	return this;
	}

	@JsonProperty("sistemas_afetados")
	public String getSistemasAfetados() {
	return sistemasAfetados;
	}

	@JsonProperty("sistemasafetadosformatado")
	public String getSistemasafetadosformatado() {
	return sistemasAfetados;
	}

	@JsonProperty("sistemas_afetados")
	public void setSistemasAfetados(String sistemasAfetados) {
	this.sistemasAfetados = sistemasAfetados;
	}

	public Vulnerability withSistemasAfetados(String sistemasAfetados) {
	this.sistemasAfetados = sistemasAfetados;
	return this;
	}

	@JsonProperty("melhores_praticas")
	public String getMelhoresPraticas() {
	return melhoresPraticas;
	}

	@JsonProperty("melhorespraticasformatado")
	public String getMelhorespraticasformatado() {
	return melhoresPraticas;
	}

	@JsonProperty("melhores_praticas")
	public void setMelhoresPraticas(String melhoresPraticas) {
	this.melhoresPraticas = melhoresPraticas;
	}

	public Vulnerability withMelhoresPraticas(String melhoresPraticas) {
	this.melhoresPraticas = melhoresPraticas;
	return this;
	}

	@JsonProperty("modelagens")
	public String getModelagens() {
	return modelagens;
	}

	@JsonProperty("modelagens")
	public void setModelagens(String modelagens) {
	this.modelagens = modelagens;
	}

	public Vulnerability withModelagens(String modelagens) {
	this.modelagens = modelagens;
	return this;
	}

	@JsonProperty("classificador")
	public String getClassificador() {
	return classificador;
	}

	@JsonProperty("classificador")
	public void setClassificador(String classificador) {
	this.classificador = classificador;
	}

	public Vulnerability withClassificador(String classificador) {
	this.classificador = classificador;
	return this;
	}

	@JsonProperty("evidencias")
	public List<Evidency> getEvidencia() {
	return evidencias;
	}

	@JsonProperty("evidencias")
	public void setEvidencia(List<Evidency> evidencias) {
	this.evidencias = evidencias;
	}

	public Vulnerability withEvidencia(List<Evidency> evidencias) {
	this.evidencias = evidencias;
	return this;
	}

	@JsonProperty("reteste")
	public List<Retest> getRetestes() {
	return reteste;
	}

	@JsonProperty("reteste")
	public void setRetestes(List<Retest> reteste) {
	this.reteste = reteste;
	}

	public Vulnerability withReteste(List<Retest> reteste) {
	this.reteste = reteste;
	return this;
	}

	@JsonProperty("id_archer")
	public String getIdArcher() {
	return idArcher;
	}

	@JsonProperty("idarcherformatado")
	public String getIdarcherformatado() {
	return idArcher;
	}

	@JsonProperty("id_archer")
	public void setIdArcher(String idArcher) {
	this.idArcher = idArcher;
	}

	public Vulnerability withIdArcher(String idArcher) {
	this.idArcher = idArcher;
	return this;
	}

	@JsonProperty("rfc")
	public String getRfc() {
	return rfc;
	}

	@JsonProperty("rfc")
	public void setRfc(String rfc) {
	this.rfc = rfc;
	}

	public Vulnerability withRfc(String rfc) {
	this.rfc = rfc;
	return this;
	}

	@JsonProperty("tipificacao")
	public String getTipificacao() {
	return tipificacao;
	}

	@JsonProperty("tipificacao")
	public void setTipificacao(String tipificacao) {
	this.tipificacao = tipificacao;
	}

	public Vulnerability withTipificacao(String tipificacao) {
	this.tipificacao = tipificacao;
	return this;
	}

	@JsonProperty("risco_de_negocio")
	public String getRiscoDeNegocio() {
	return riscoDeNegocio;
	}

	@JsonProperty("riscodenegocioformatado")
	public String getRiscodenegocioformatado() {
	return riscoDeNegocio;
	}

	@JsonProperty("risco_de_negocio")
	public void setRiscoDeNegocio(String riscoDeNegocio) {
	this.riscoDeNegocio = riscoDeNegocio;
	}

	public Vulnerability withRiscoDeNegocio(String riscoDeNegocio) {
	this.riscoDeNegocio = riscoDeNegocio;
	return this;
	}

	@JsonProperty("logo")
	public String getLogo() {
	return logo;
	}

	@JsonProperty("logo")
	public void setLogo(String logo) {
		this.logo = (logo.contains(",")) ? logo.split(",")[1] : logo;
	}

	public Vulnerability withLogo(String logo) {
	this.logo = logo;
	return this;
	}
	
	@JsonProperty("cliente")
	public String getCliente() {
	return cliente;
	}

	@JsonProperty("cliente")
	public void setCliente(String cliente) {
		this.cliente = cliente;
	}

	public Vulnerability withCliente(String cliente) {
	this.cliente = cliente;
	return this;
	}
	
	@JsonProperty("projeto")
	public String getProjeto() {
	return projeto;
	}

	@JsonProperty("projeto")
	public void setProjeto(String projeto) {
		this.projeto = projeto;
	}

	public Vulnerability withProjeto(String projeto) {
	this.projeto = projeto;
	return this;
	}

	@JsonProperty("apontamentos")
	public List<Vulnerability> getApontamentos() {
	return apontamentos;
	}

	@JsonProperty("apontamentos")
	public void setApontamentos(List<Vulnerability> apontamentos) {
	this.apontamentos = apontamentos;
	}

	public Vulnerability withApontamentos(List<Vulnerability> apontamentos) {
	this.apontamentos = apontamentos;
	return this;
	}

	@JsonProperty("subretestes")
	public List<Retest> getSubretestes() {
	return subretestes;
	}

	@JsonProperty("subretestes")
	public void setSubretestes(List<Retest> subretestes) {
	this.subretestes = subretestes;
	}
	
	public Vulnerability withSubretestes(List<Retest> subretestes) {
	this.subretestes = subretestes;
	return this;
	}
	
	@JsonProperty("subretestereport")
	public JasperReport getSubretestereport() {
	return subretestereport;
	}

	@JsonProperty("subretestereport")
	public void setSubretestereport(JasperReport subretestereport) {
	this.subretestereport = subretestereport;
	}

	public Vulnerability withSubretestereport(JasperReport subretestereport) {
	this.subretestereport = subretestereport;
	return this;
	}

	@JsonAnyGetter
	public Map<String, Object> getAdditionalProperties() {
	return this.additionalProperties;
	}

	@JsonAnySetter
	public void setAdditionalProperty(String name, Object value) {
	this.additionalProperties.put(name, value);
	}

	public Vulnerability withAdditionalProperty(String name, Object value) {
	this.additionalProperties.put(name, value);
	return this;
	}
}
